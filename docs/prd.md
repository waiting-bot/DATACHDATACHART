# 产品需求文档（PRD）  
## 产品名称
智能图表生成工具（MVP）

## 产品目标
通过用户上传 Excel 文件，自动生成图表（PNG/SVG格式透明底色），并通过访问码控制生成次数，面向小红书虚拟产品销售。支持 Web 和移动端访问。MVP阶段以快速上线、成本可控为目标。  
同时要求 Claude Code 生成的代码文件结构规范化，便于后续部署和维护。

---

## 一、核心功能

### 1. 数据图表生成
- 用户上传 Excel 文件
- 系统解析数据，生成图表（PNG / SVG，透明底色）
- 支持多种图表类型（柱状图、折线图、饼图等）
- 图表生成次数受访问码限制（例如 10 / 30 / 50 次）

### 2. 访问控制
- 每个访问码绑定最大生成图表次数
- 使用次数达到上限后禁止继续生成图表
- 访问码从访问码池手动分发给下单用户
- 后端自动更新使用次数，无需人工干预

### 3. 数据安全
- Excel 文件只用于生成图表，生成后可选择删除
- 访问码信息存储在服务器数据库，数据库不对外开放

---

## 二、用户操作流程

1. **下单**
   - 用户在小红书店铺购买服务
2. **分发访问码**
   - 从访问码池选择一个访问码发给用户
3. **上传数据**
   - 用户在 Web 或移动端输入访问码验证身份
   - 上传 Excel 文件
4. **生成图表**
   - 后端验证访问码是否有效，检查使用次数
   - 调用图表生成引擎生成 PNG/SVG 图表
5. **查看/下载**
   - 用户可查看或下载生成的图表
   - 使用次数自动更新，达到上限后禁止继续生成

---

## 三、系统模块设计

### 1. 前端模块（Web + 移动端）
- **登录/访问码验证模块**：输入访问码，验证身份
- **文件上传模块**：上传 Excel 文件
- **图表展示模块**：显示生成图表，可下载
- **使用次数显示模块**（可选）：显示剩余生成次数

### 2. 后端模块
- **访问码管理模块**
  - 验证访问码有效性
  - 更新使用次数
  - 管理访问码池
- **文件解析模块**
  - 解析 Excel 文件，生成数据结构
- **图表生成模块**
  - 调用 Deepseek API 或 Python 绘图库
  - 输出 PNG / SVG 文件
- **接口模块**
  - 提供 REST API 给前端调用
- **失效文件管理模块**
  - 上传生成后及时删除过期或临时文件
  - 避免占用服务器存储

### 3. 数据库模块
- **访问码表**
```sql
CREATE TABLE access_codes (
    id SERIAL PRIMARY KEY,
    access_code VARCHAR(50) UNIQUE,
    max_usage INT,
    usage_count INT DEFAULT 0
);
存储访问码、最大生成次数、已使用次数


```markdown
# 四、技术架构与实现路径
### 1. 服务器与部署
- DigitalOcean VPS（Droplet）  
- 后端 API + 数据库部署在同一服务器  
- 前端 Web + 移动端部署在 Vercel / Netlify  
- Nginx 反向代理 + 域名/子域名绑定  

### 2. 前后端交互
- 前端上传 Excel 文件 → 调用后端 API  
- 后端验证访问码 → 解析 Excel → 生成图表 → 返回 PNG/SVG  
- 使用次数动态更新  

### 3. 多项目部署
- 不同项目使用不同目录 + 虚拟环境 + 端口 + Nginx 代理  
- 数据库可分不同实例或不同表  

### 4. 代码文件管理规范
- 目录结构：

/project-root
/frontend # Web + 移动端页面
/backend # 后端 API 和文件解析逻辑
/scripts # Python 脚本或定时任务
/assets # 前端静态资源
/docs # 文档和 PRD

- 文件管理：临时文件生成后及时删除，避免占用存储  
- Git 提交规范：commit message `[模块] 描述`，功能完成才合并主分支

# 五、MVP开发路径
1. 访问码管理：生成访问码池（10 / 30 / 50次）、建表、使用次数限制逻辑  
2. Excel 上传与解析：前端上传，后端 Python 解析 → 输出 Array-Object 数据结构  
3. 图表生成：调用 Deepseek API 或 Python 绘图库 → 返回 PNG/SVG  
4. 前端展示与下载：显示生成图表，提供下载按钮  
5. 部署：后端 + 数据库在 DigitalOcean，前端在 Vercel / Netlify，Nginx 反向代理

# 六、后续迭代建议
- 支持 PPT / Excel 可编辑图表导出  
- 自动化小红书订单对接，实时生成访问码  
- 可设置访问码有效期  
- 图表加用户信息水印防止滥用  
- 分析访问码使用数据优化成本与产品

# 七、优势
- MVP快速上线，成本可控  
- 用户操作简单，Web + 移动端支持  
- 后端逻辑稳定，可扩展多项目部署  
- 代码结构规范，便于后续迭代与维护
